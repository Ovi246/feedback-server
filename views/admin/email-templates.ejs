<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Email Templates - Study Key</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <div class="container-fluid">
        <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="/admin">Study Key Admin</a>
                <div class="navbar-nav ms-auto">
                    <span class="navbar-text">Email Templates</span>
                </div>
            </div>
        </nav>

        <div class="container mt-4">
            <div class="row">
                <div class="col-md-12">
                    <div class="card">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <h5 class="mb-0"><i class="fas fa-envelope-open-text"></i> Email Templates</h5>
                            <a href="/admin/feedback?token=<%= token %>" class="btn btn-outline-secondary">
                                <i class="fas fa-arrow-left"></i> Back to Feedback Manager
                            </a>
                        </div>
                        <div class="card-body">
                            <div class="alert alert-info">
                                <i class="fas fa-info-circle"></i> 
                                Use these placeholders in your templates: <code>{{customerName}}</code>, <code>{{productName}}</code>, <code>{{reviewUrl}}</code>, <code>{{productUrl}}</code>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6">
                                    <h6>Day 3 Template</h6>
                                    <form id="template-form-3">
                                        <input type="hidden" name="day" value="3">
                                        <div class="mb-3">
                                            <label class="form-label">Subject</label>
                                            <input type="text" name="subject" class="form-control" value="{{customerName}}, how's your Study Key product? üéØ">
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">HTML Content</label>
                                            <textarea name="htmlContent" class="form-control" rows="10"><!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{customerName}}, how's your Study Key product?</title>
</head>
<body style="margin: 0; padding: 0; font-family: Arial, sans-serif; background-color: #f4f4f4;">
  <table role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%" style="background-color: #f4f4f4;">
    <tr>
      <td style="padding: 20px 0;">
        <table role="presentation" cellspacing="0" cellpadding="0" border="0" width="600" align="center" style="background-color: #ffffff; border-radius: 8px;">
          <!-- Header -->
          <tr>
            <td style="padding: 30px 30px 20px 30px; text-align: center;">
              <h1 style="color: #333333; margin: 0; font-size: 24px;">Hi {{customerName}}! üëã</h1>
            </td>
          </tr>
          
          <!-- Content -->
          <tr>
            <td style="padding: 0 30px 20px 30px;">
              <p style="margin: 0 0 15px 0; font-size: 16px; color: #555555; line-height: 1.5;">
                It's been 3 days since you claimed your Study Key reward. We hope you're enjoying <strong>{{productName}}</strong>!
              </p>
              
              <p style="margin: 0 0 20px 0; font-size: 16px; color: #555555; line-height: 1.5;">
                <strong>Would you mind sharing your experience?</strong>
              </p>
              
              <p style="margin: 0 0 30px 0; font-size: 16px; color: #555555; line-height: 1.5;">
                Your honest Amazon review helps us improve and helps other customers make informed decisions. It only takes a minute!
              </p>
              
              <table role="presentation" cellspacing="0" cellpadding="0" border="0" style="margin: 0 auto 30px auto;">
                <tr>
                  <td style="border-radius: 5px; background-color: #FF9900;">
                    <a href="{{reviewUrl}}" target="_blank" style="display: inline-block; padding: 15px 30px; font-family: Arial, sans-serif; font-size: 16px; color: #ffffff; text-decoration: none; font-weight: bold;">
                      Write Your Review
                    </a>
                  </td>
                </tr>
              </table>
              
              {{#if productUrl}}
              <p style="margin: 0 0 20px 0; text-align: center;">
                <a href="{{productUrl}}" target="_blank" style="color: #0066c0; text-decoration: none; font-size: 14px;">View {{productName}} on Amazon</a>
              </p>
              {{/if}}
              
              <p style="margin: 0 0 20px 0; font-size: 16px; color: #555555; line-height: 1.5;">
                Thank you for being part of our community!
              </p>
            </td>
          </tr>
          
          <!-- Footer -->
          <tr>
            <td style="padding: 20px 30px; text-align: center; background-color: #f9f9f9; border-top: 1px solid #dddddd; font-size: 12px; color: #666666;">
              <p style="margin: 0;">
                You're receiving this because you claimed a Study Key reward. If you've already left a review, thank you! You can ignore this email.
              </p>
            </td>
          </tr>
        </table>
      </td>
    </tr>
  </table>
</body>
</html></textarea>
                                        </div>
                                        <div class="mb-3 form-check">
                                            <input type="checkbox" name="isActive" class="form-check-input" checked>
                                            <label class="form-check-label">Active</label>
                                        </div>
                                        <button type="submit" class="btn btn-primary">Save Template</button>
                                    </form>
                                </div>
                                
                                <div class="col-md-6">
                                    <h6>Day 7 Template</h6>
                                    <form id="template-form-7">
                                        <input type="hidden" name="day" value="7">
                                        <div class="mb-3">
                                            <label class="form-label">Subject</label>
                                            <input type="text" name="subject" class="form-control" value="{{customerName}}, share your Study Key experience? üìù">
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">HTML Content</label>
                                            <textarea name="htmlContent" class="form-control" rows="10"><!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{customerName}}, share your Study Key experience?</title>
</head>
<body style="margin: 0; padding: 0; font-family: Arial, sans-serif; background-color: #f4f4f4;">
  <table role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%" style="background-color: #f4f4f4;">
    <tr>
      <td style="padding: 20px 0;">
        <table role="presentation" cellspacing="0" cellpadding="0" border="0" width="600" align="center" style="background-color: #ffffff; border-radius: 8px;">
          <!-- Header -->
          <tr>
            <td style="padding: 30px 30px 20px 30px; text-align: center;">
              <h1 style="color: #333333; margin: 0; font-size: 24px;">Hi {{customerName}}! üìù</h1>
            </td>
          </tr>
          
          <!-- Content -->
          <tr>
            <td style="padding: 0 30px 20px 30px;">
              <p style="margin: 0 0 15px 0; font-size: 16px; color: #555555; line-height: 1.5;">
                It's been 7 days since you received your Study Key product. How are you finding <strong>{{productName}}</strong>?
              </p>
              
              <p style="margin: 0 0 20px 0; font-size: 16px; color: #555555; line-height: 1.5;">
                <strong>We'd love to hear your thoughts!</strong>
              </p>
              
              <p style="margin: 0 0 30px 0; font-size: 16px; color: #555555; line-height: 1.5;">
                Sharing your experience on Amazon helps other customers discover great products like yours. Plus, it helps us continue to offer quality rewards!
              </p>
              
              <table role="presentation" cellspacing="0" cellpadding="0" border="0" style="margin: 0 auto 30px auto;">
                <tr>
                  <td style="border-radius: 5px; background-color: #FF9900;">
                    <a href="{{reviewUrl}}" target="_blank" style="display: inline-block; padding: 15px 30px; font-family: Arial, sans-serif; font-size: 16px; color: #ffffff; text-decoration: none; font-weight: bold;">
                      Leave Your Review
                    </a>
                  </td>
                </tr>
              </table>
              
              {{#if productUrl}}
              <p style="margin: 0 0 20px 0; text-align: center;">
                <a href="{{productUrl}}" target="_blank" style="color: #0066c0; text-decoration: none; font-size: 14px;">View {{productName}} on Amazon</a>
              </p>
              {{/if}}
              
              <p style="margin: 0 0 20px 0; font-size: 16px; color: #555555; line-height: 1.5;">
                Your feedback means a lot to us!
              </p>
            </td>
          </tr>
          
          <!-- Footer -->
          <tr>
            <td style="padding: 20px 30px; text-align: center; background-color: #f9f9f9; border-top: 1px solid #dddddd; font-size: 12px; color: #666666;">
              <p style="margin: 0;">
                You're receiving this because you claimed a Study Key reward. If you've already left a review, thank you! You can ignore this email.
              </p>
            </td>
          </tr>
        </table>
      </td>
    </tr>
  </table>
</body>
</html></textarea>
                                        </div>
                                        <div class="mb-3 form-check">
                                            <input type="checkbox" name="isActive" class="form-check-input" checked>
                                            <label class="form-check-label">Active</label>
                                        </div>
                                        <button type="submit" class="btn btn-primary">Save Template</button>
                                    </form>
                                </div>
                                
                                <div class="col-md-6">
                                    <h6>Day 14 Template</h6>
                                    <form id="template-form-14">
                                        <input type="hidden" name="day" value="14">
                                        <div class="mb-3">
                                            <label class="form-label">Subject</label>
                                            <input type="text" name="subject" class="form-control" value="{{customerName}}, your feedback matters to us! üí≠">
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">HTML Content</label>
                                            <textarea name="htmlContent" class="form-control" rows="10"><!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{customerName}}, your feedback matters!</title>
</head>
<body style="margin: 0; padding: 0; font-family: Arial, sans-serif; background-color: #f4f4f4;">
  <table role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%" style="background-color: #f4f4f4;">
    <tr>
      <td style="padding: 20px 0;">
        <table role="presentation" cellspacing="0" cellpadding="0" border="0" width="600" align="center" style="background-color: #ffffff; border-radius: 8px;">
          <!-- Header -->
          <tr>
            <td style="padding: 30px 30px 20px 30px; text-align: center;">
              <h1 style="color: #333333; margin: 0; font-size: 24px;">Hi {{customerName}}! üí≠</h1>
            </td>
          </tr>
          
          <!-- Content -->
          <tr>
            <td style="padding: 0 30px 20px 30px;">
              <p style="margin: 0 0 15px 0; font-size: 16px; color: #555555; line-height: 1.5;">
                It's been 2 weeks since you received your Study Key product. We hope <strong>{{productName}}</strong> continues to meet your expectations!
              </p>
              
              <p style="margin: 0 0 20px 0; font-size: 16px; color: #555555; line-height: 1.5;">
                <strong>Your feedback really matters to us and other customers.</strong>
              </p>
              
              <p style="margin: 0 0 30px 0; font-size: 16px; color: #555555; line-height: 1.5;">
                Taking a moment to leave an Amazon review helps us understand what we're doing right and where we can improve. Plus, it guides other customers in their purchasing decisions.
              </p>
              
              <table role="presentation" cellspacing="0" cellpadding="0" border="0" style="margin: 0 auto 30px auto;">
                <tr>
                  <td style="border-radius: 5px; background-color: #FF9900;">
                    <a href="{{reviewUrl}}" target="_blank" style="display: inline-block; padding: 15px 30px; font-family: Arial, sans-serif; font-size: 16px; color: #ffffff; text-decoration: none; font-weight: bold;">
                      Share Your Thoughts
                    </a>
                  </td>
                </tr>
              </table>
              
              {{#if productUrl}}
              <p style="margin: 0 0 20px 0; text-align: center;">
                <a href="{{productUrl}}" target="_blank" style="color: #0066c0; text-decoration: none; font-size: 14px;">View {{productName}} on Amazon</a>
              </p>
              {{/if}}
              
              <p style="margin: 0 0 20px 0; font-size: 16px; color: #555555; line-height: 1.5;">
                Thank you for taking the time to help us grow!
              </p>
            </td>
          </tr>
          
          <!-- Footer -->
          <tr>
            <td style="padding: 20px 30px; text-align: center; background-color: #f9f9f9; border-top: 1px solid #dddddd; font-size: 12px; color: #666666;">
              <p style="margin: 0;">
                You're receiving this because you claimed a Study Key reward. If you've already left a review, thank you! You can ignore this email.
              </p>
            </td>
          </tr>
        </table>
      </td>
    </tr>
  </table>
</body>
</html></textarea>
                                        </div>
                                        <div class="mb-3 form-check">
                                            <input type="checkbox" name="isActive" class="form-check-input" checked>
                                            <label class="form-check-label">Active</label>
                                        </div>
                                        <button type="submit" class="btn btn-primary">Save Template</button>
                                    </form>
                                </div>
                                
                                <div class="col-md-6">
                                    <h6>Day 30 Template</h6>
                                    <form id="template-form-30">
                                        <input type="hidden" name="day" value="30">
                                        <div class="mb-3">
                                            <label class="form-label">Subject</label>
                                            <input type="text" name="subject" class="form-control" value="Final reminder: Share your Study Key review üåü">
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">HTML Content</label>
                                            <textarea name="htmlContent" class="form-control" rows="10"><!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{customerName}}, final review reminder</title>
</head>
<body style="margin: 0; padding: 0; font-family: Arial, sans-serif; background-color: #f4f4f4;">
  <table role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%" style="background-color: #f4f4f4;">
    <tr>
      <td style="padding: 20px 0;">
        <table role="presentation" cellspacing="0" cellpadding="0" border="0" width="600" align="center" style="background-color: #ffffff; border-radius: 8px;">
          <!-- Header -->
          <tr>
            <td style="padding: 30px 30px 20px 30px; text-align: center;">
              <h1 style="color: #333333; margin: 0; font-size: 24px;">Hi {{customerName}}! üåü</h1>
            </td>
          </tr>
          
          <!-- Content -->
          <tr>
            <td style="padding: 0 30px 20px 30px;">
              <p style="margin: 0 0 15px 0; font-size: 16px; color: #555555; line-height: 1.5;">
                It's been a month since you received your Study Key product. We hope <strong>{{productName}}</strong> has been everything you hoped for!
              </p>
              
              <p style="margin: 0 0 20px 0; font-size: 16px; color: #555555; line-height: 1.5;">
                <strong>Final reminder to share your experience!</strong>
              </p>
              
              <p style="margin: 0 0 30px 0; font-size: 16px; color: #555555; line-height: 1.5;">
                If you haven't already, we'd love to hear your thoughts on Amazon. Your review helps us continue offering quality rewards and helps other customers make informed decisions.
              </p>
              
              <table role="presentation" cellspacing="0" cellpadding="0" border="0" style="margin: 0 auto 30px auto;">
                <tr>
                  <td style="border-radius: 5px; background-color: #FF9900;">
                    <a href="{{reviewUrl}}" target="_blank" style="display: inline-block; padding: 15px 30px; font-family: Arial, sans-serif; font-size: 16px; color: #ffffff; text-decoration: none; font-weight: bold;">
                      Write Your Review Now
                    </a>
                  </td>
                </tr>
              </table>
              
              {{#if productUrl}}
              <p style="margin: 0 0 20px 0; text-align: center;">
                <a href="{{productUrl}}" target="_blank" style="color: #0066c0; text-decoration: none; font-size: 14px;">View {{productName}} on Amazon</a>
              </p>
              {{/if}}
              
              <p style="margin: 0 0 20px 0; font-size: 16px; color: #555555; line-height: 1.5;">
                Thank you for being part of our community!
              </p>
            </td>
          </tr>
          
          <!-- Footer -->
          <tr>
            <td style="padding: 20px 30px; text-align: center; background-color: #f9f9f9; border-top: 1px solid #dddddd; font-size: 12px; color: #666666;">
              <p style="margin: 0;">
                You're receiving this because you claimed a Study Key reward. If you've already left a review, thank you! You can ignore this email.
              </p>
            </td>
          </tr>
        </table>
      </td>
    </tr>
  </table>
</body>
</html></textarea>
                                        </div>
                                        <div class="mb-3 form-check">
                                            <input type="checkbox" name="isActive" class="form-check-input" checked>
                                            <label class="form-check-label">Active</label>
                                        </div>
                                        <button type="submit" class="btn btn-primary">Save Template</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        document.querySelectorAll('form[id^="template-form-"]').forEach(form => {
            form.addEventListener('submit', async (e) => {
                e.preventDefault();
                
                const formData = new FormData(e.target);
                const data = Object.fromEntries(formData);
                data.isActive = formData.get('isActive') === 'on';
                
                try {
                    const response = await fetch('/api/admin/email-templates', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-Admin-Token': '<%= token %>'
                        },
                        body: JSON.stringify(data)
                    });
                    
                    const result = await response.json();
                    if (result.success) {
                        alert('Template saved successfully!');
                    } else {
                        alert('Failed to save template: ' + result.message);
                    }
                } catch (error) {
                    console.error('Error saving template:', error);
                    alert('Error saving template');
                }
            });
        });
    </script>
</body>
</html>